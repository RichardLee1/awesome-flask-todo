"use strict";function activeLine(t){t||(t=$(".share-nav .active")),line.css({left:t.offset().left,width:t.width()})}function autoHeight(){var t=$(window).height();$(".share-content").height(t-paddingTop)}function getResource(){var t=$('textarea[data-type="options"]').val(),e=JSON.parse(t),a=e.resouces,n=e.libs;if(""===a&&""===n)return!1;""!==a&&""!==n?a=a+","+n:a+=n,""!==n?$.getJSON(staticBase+"scripts/cdns.json",function(t){cdns=t,dealResouce(a,e)}):dealResouce(a,e);var r=$(".share-nav .active a").attr("href").replace("#","");1===$(".share-nav li").length&&"result"===r&&(paddingTop=0)}function isNumber(t){return null!==t&&""!==t&&!isNaN(t)}function getCdn(t){var e,a,n=null;for(e in cdns)if(a=cdns[e],n=_.find(a.files,function(e){return e.id==t}))return n.url}function getTheme(t){t=t.toLocaleLowerCase()+".js";var e=cdns["Highcharts-themes"],a=_.find(e.files,function(e){return e.name===t});return a?a.url:null}function dealResouce(t,e){var a=t.split(","),n=e.doctype,r="",l="",i="",s=$('textarea[data-type="html"]').val();if(e.theme){var o=getTheme(e.theme);null!==o&&a.push(o)}_.each(a,function(t){var e="";e=isNumber(t)?getCdn(t):t;var a=new RegExp(urlReg);if(a.test(e)){var n=e.split("."),r=n[n.length-1];"js"===r?l+='\n\t\t<script src="'+e+'"></script>':"css"===r&&(i+='\n\t\t<link rel="stylesheet" type="text/css" href="'+e+'"/>')}}),r=i+"\n\t\t<style>\n\t\t /* css 代码  */\n\t\t</style>"+l,$('textarea[data-type="html"]').val(htmlTemplate({doctype:doctypes[n],html:s,libs:r})),run()}function run(){var t=$(".share-nav .active a").attr("href").replace("#","");if(t=t.toLocaleLowerCase(),"result"===t){if(isRun)return!1;var e=$('textarea[data-type="html"]').val(),a=$('textarea[data-type="css"]').val(),n=$('textarea[data-type="js"]').val(),r=null,l=null;$("#result").html(iframeTemplte),r=document.getElementById("ifr"),l=r.contentDocument||r.contentWindow.document,l.open();var i=e.split(" // JS 代码 ");a="body {margin:0}"+a,l.write((i[0]+n+i[1]).replace("/* css 代码  */",a)),l.close(),isRun=!0}else if(null===editors[t].obj){var s=$('textarea[data-target="'+t+'"]');s.val($('textarea[data-type="'+t+'"]').val()),editors[t].obj=CodeMirror.fromTextArea(s[0],{mode:editors[t].mode,tabindex:4,lineNumbers:!0,lineWrapping:!0,scrollbarStyle:"overlay",indentUnit:4,readOnly:!0}),"html"===t&&editors[t].obj.autoFormatRange({line:0,ch:0},{line:editors[t].obj.lineCount()})}}var line=$(".active-line"),editors={result:null,html:{obj:null,mode:"text/html"},css:{obj:null,mode:"text/css"},js:{obj:null,mode:"javascript"}},isWebkit=navigator.userAgent.indexOf(" AppleWebKit/")>-1,iframeTemplte='<iframe id="ifr" sandbox="allow-forms allow-popups'+(isWebkit?" allow-modals ":" ")+'allow-scripts allow-same-origin"></iframe>',doctypes=["<!doctype html>",'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">','<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">','<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">','<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">','<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">','<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">','<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">'],staticBase=$('meta[name="staticBase"]').attr("content"),cdns=null,urlReg="^[A-Za-z]+://[A-Za-z0-9-_]+\\.[A-Za-z0-9-_%&?/.=]+$",htmlTemplate=_.template('<%=doctype%>\n<html>\n\t<head>\n\t\t<meta charset="utf-8"><%=libs%>\n\t</head>\n\t<body>\n\t\t<%=html%>\n\t\t<script>\n\t\t // JS 代码 \n\t\t</script>\n\t</body>\n</html>'),needRun=!1,paddingTop=50,isRun=!1;getResource(),activeLine(),autoHeight(),$(window).resize(autoHeight),$(".share-nav a").click(function(){var t=$(this),e=null;return!t.hasClass("active")&&($(".share-nav .active").removeClass("active"),t.parent().addClass("active"),activeLine(t.parent()),e=t.attr("href"),$(".tab-pane").hide(),$(e).show(),void run())});